% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rankTest.R
\name{rankTest}
\alias{rankTest}
\title{Rank-score test for quantile regression}
\usage{
rankTest(mod, X, tau = NULL, full = FALSE, h = NULL, alpha = 0.05,
eps = c(1e-04,1e-04), A = NULL, error.distr = NULL, error.par = NULL)
}
\arguments{
\item{mod}{An object of class \code{rqs} returned by
\code{\link[quantreg]{rq}}, representing the fitted quantile regression models.}

\item{X}{A string indicating the covariate of interest.}

\item{tau}{A numeric vector of quantiles of interest used in \code{mod}.
If \code{NULL} (default), all quantiles from the \code{mod} object are considered.}

\item{full}{Logical. If \code{TRUE}, the function returns the test statistics
and corresponding \eqn{p}-values for all intersection hypotheses containing
\code{tau}. If \code{FALSE} (default), only the results for the single hypotheses
are returned.}

\item{h}{A numeric value for the bandwidth.}

\item{alpha}{A numeric value used for bandwidth estimation.
Following Koenker (2005), it is typically set equal to the desired significance level.}

\item{eps}{2d vector of relative accuracies requested for approximate the distribution of the test statistic
by Imhof (1961) "Computing the Distribution of Quadratic Forms in Normal Variables"}

\item{A}{Optional weighting matrix (or a list of matrices) used in the
computation of the test statistic.

If \code{NULL} (default), the identity matrix is used for each intersection
hypothesis.

If a single numeric value is supplied, it is interpreted as a scalar and the
weighting matrix is set to \eqn{A = c I_k}.

If a list is provided, it must contain one matrix for each tested intersection
hypothesis, and each matrix must be square with dimension equal to the size
of the corresponding quantile subset.

This argument is ignored when \code{error.distr} is specified.}

\item{error.distr}{A character string specifying the assumed distribution of
the regression errors, used to construct the weighting matrix \eqn{A} based on
the reciprocal of the error density evaluated at the relevant quantile levels.

Allowed values are:
\itemize{
  \item \code{NULL}: default, no distributional assumption; the argument \code{A} is used instead.
  \item \code{"normal"}: normal errors with parameters specified in \code{error.par}.
  \item \code{"exponential"}: exponential errors with rate/scale specified in \code{error.par}.
  \item \code{"t"}: Student-\eqn{t} errors with degrees of freedom specified in \code{error.par}.
}

When \code{error.distr} is not \code{NULL}, the argument \code{A} is ignored and the
matrix \eqn{A} is automatically set to a diagonal matrix with entries
\eqn{1 / f(F^{-1}(\tau_j))}, where \eqn{f} is the density of the specified
error distribution and \eqn{F^{-1}} its quantile function.}

\item{error.par}{A named list of parameters associated with the distribution
specified in \code{error.distr}.

Required elements depend on the chosen distribution:
\itemize{
  \item For \code{"normal"}: \code{mean} (default 0), \code{sd} (default 1).
  \item For \code{"exponential"}: either \code{rate} or \code{scale} (default \code{rate = 1}).
  \item For \code{"t"}: \code{df} (degrees of freedom, required).
}}
}
\value{
A \code{data.frame} containing:
\itemize{
  \item \code{Quantiles.Set}: quantile levels
  \item \code{Statistic}: rank-score test statistic
  \item \code{p.value}: corresponding unadjusted \eqn{p}-value
}
}
\description{
Performs the rank-score test for the covariate of interest
\code{X}, at the quantiles defined in \code{tau}, using a fitted quantile
regression model. The test evaluates the null hypothesis that the coefficient of \code{X} is equal to zero
against a two-sided alternative, at each specified quantile level.
Testing equality to a non-zero value is not yet implemented.
}
\details{
This procedure requires that the covariate of interest \code{X} is either numeric
or, if categorical, has at most two levels. Multilevel categorical covariates
are not supported and will trigger an error.
}
\examples{
set.seed(1234)
D <- simulateData(n = 100, gamma = 0.5, sigma.y = "1 + 2 * pmax(X, 0)")

#Quantile regressions at different levels
tau <- c(0.1, 0.25, 0.5, 0.75, 0.9)
mod <- quantreg::rq(y ~ X + Z1, tau = tau, data=D)

# Rank test
rankTest(mod, X = "X")
}
\references{
Koenker, R. (2005). \emph{Quantile Regression}. Cambridge University Press.
}
\seealso{
\code{\link[quantreg]{rq}}, \code{\link[quasar]{waldTest}}
}
\author{
Angela Andreella
}
